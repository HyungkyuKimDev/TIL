# 2025/06/17 TIL

## 클라우드 & 인프라 지식 정리

---

### 1. 용어 정리

| 용어 | 정의 | 실무에서의 위치 | 주의사항 / 보충 |
|------|------|----------------|----------------|
| **Subscription (서브스크립션)** | 클라우드 리소스를 묶어서 **요금 및 권한**을 관리하는 단위 | AWS: 계정 단위, Azure: Subscription 단위 | 권한/과금 분리 핵심 단위. 조직마다 복수 운영 가능 |
| **Console (콘솔)** | 클라우드의 **웹 GUI 관리도구** | AWS Console, Azure Portal 등 | CLI보다 직관적이나 반복 작업은 불리 |
| **FW (Firewall)** | **네트워크 접근 제어** 설정 | OS(iptable/ufw), 클라우드(보안 그룹 등) | 포트 충돌 및 외부 공개(0.0.0.0/0) 방지 |
| **IPCクラウド** | 일본 국산 클라우드 (VMware 기반 IaaS) | 중소·지방 기업 중심 활용 | 일본 내 고정 IP/고가용성 옵션 중심 |

---

### 2. 서버 이미지화 및 신규 구축 작업

#### ✅ 전제 흐름 (공통)

- [기존 서버] → 디스크 이미지화(VHD/OVF 등)
- → 대상 클라우드 포맷에 맞게 변환
- → 클라우드에 업로드 & 등록
- → 변환된 이미지를 기반으로 신규 서버 생성

#### 📌 설정 포인트 (모든 환경 공통)
- 네트워크 충돌 방지 (IP, hostname 변경)
- NIC 이름 일치 확인
- 방화벽 설정 (OS 및 클라우드 보안 그룹)
- crontab, systemd 등 자동 실행 확인
- DNS/라우팅 수정 여부 검토
- 디스크 용량 확장 고려 (fdisk, resize2fs 등)

---

### 3. 구축 환경별 비교 (3가지 케이스)

#### 🔹 1. 온프레미스 → 온프레미스

| 항목 | 설명 |
|------|------|
| 사용 도구 | Clonezilla, dd, Acronis, Ghost |
| 작업 방식 | 이미지 백업 후 새로운 하드웨어에 복원, LiveCD 부팅 후 설정 수정 |
| 난이도 | ★★☆☆☆ (초중급) |
| 주의점 | 드라이버 충돌, NIC 이름 변경, 부트로더 문제 가능 |

---

#### 🔹 2. 온프레미스 → 클라우드

| 항목 | 설명 |
|------|------|
| 사용 도구 | AWS VM Import/Export, Azure Migrate 등 |
| 변환 포맷 | VHD, OVF 등 |
| 생성 방식 | 클라우드 콘솔에 업로드 → 이미지 등록 후 인스턴스 생성 |
| 난이도 | ★★★★☆ (상급) |
| 주의점 | VPC 구조, 보안 그룹, 인증, IP 변경 등 환경 적응 필요 |

---

#### 🔹 3. 클라우드 → 클라우드

| 항목 | 설명 |
|------|------|
| 예시 | AWS → Azure: AMI → VHD 변환 후 업로드 |
| 사용 도구 | CloudEndure, 이미지 export/import 기능 |
| 생성 방식 | 등록된 이미지로 VM 생성 |
| 난이도 | ★★★☆☆ (중급) |
| 주의점 | 스토리지 구조, 인증서 포맷, 네트워크 구조 차이 대응 필요 |

---

### 4. 클라우드 서버 생성 시 이미지 사용 방식

#### ❓ Q. 클라우드에서 OS를 먼저 선택하고, 나중에 기존 이미지를 덮어씌우는 방식인가?

❌ **아니다.**

✅ **이미지를 먼저 변환/등록하고, 그 이미지로부터 서버를 새로 만든다.**

- 클라우드에서는 "OS 선택 → 덮어쓰기" 방식 ❌  
- 대신, "이미지 자체 = OS + 설정 포함 덩어리" ✔️

---

#### 📌 실무 예시 흐름

**온프레미스 → AWS**
1. VHD 또는 OVF 형식으로 이미지 추출
2. AWS S3에 업로드
3. VM Import → AMI 등록
4. 해당 AMI로 EC2 인스턴스 생성

**AWS → Azure**
1. EC2 인스턴스를 AMI로 저장
2. AMI를 VHD로 변환 후 Azure에 업로드
3. Azure에서 이미지 등록
4. 이미지 기반으로 Azure VM 생성

---

### 5. 요약 정리

- 클라우드 마이그레이션은 모두 "이미지 → 서버 생성" 방식이 표준
- 기존 서버 이미지를 대상 클라우드 포맷으로 변환하는 것이 선행됨
- LiveCD로 부팅해서 네트워크 설정 변경하는 작업은 **온프레 환경에선 빈번**, 클라우드 환경에선 **이미지 자체를 수정하거나 UserData로 자동화**
- OS를 따로 고르고 덮어씌우는 방식은 **비권장 / 오류 유발 가능성 높음**
- 실무에서는 반드시 체크리스트 기반으로 네트워크/부트/스토리지 항목 점검